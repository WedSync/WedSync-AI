# TECHNICAL SPECIFICATION: WS-187 - App Store Preparation
## Generated by Feature Development Session - August 25, 2025

### USER STORY & BUSINESS CONTEXT (THINK HARD - BE FACTUAL)
**As a:** WedSync business stakeholder preparing for market expansion and credibility
**I want to:** Prepare our PWA for distribution through Microsoft Store, Google Play (TWA), and eventual Apple App Store presence with optimized metadata and visuals
**So that:** I can reach wedding suppliers who discover apps through official stores, establish platform credibility, and maximize downloads through app store optimization strategies

**Real Wedding Scenario:**
Many wedding photographers search for "wedding business app" directly in app stores rather than Google. Without app store presence, WedSync loses potential users to competitors. App store preparation involves creating the required 1290x2796 iPhone screenshots showing WedSync's dashboard, optimizing the description with keywords like "wedding vendor" and "photographer tools," and submitting the PWA through Trusted Web Activity for Google Play, capturing users who prefer official app store discovery.

### SPECIFICATION SOURCE
- **Feature ID:** WS-187
- **Original Spec:** /CORE-SPECIFICATIONS/09-MOBILE-OPTIMIZATION/06-app-store-preparation md.md
- **Current Implementation:** 0% complete (new)
- **Files to Modify:** 
  - `/wedsync/public/manifest.json` (enhance for store compatibility)
  - `/wedsync/next.config.ts` (add app store metadata)
- **New Files to Create:** 
  - `/wedsync/public/store-assets/` (screenshots, icons, metadata)
  - `/wedsync/scripts/app-store-build.js`
  - `/wedsync/capacitor.config.ts` (for native wrapping)
  - `/wedsync/android/` (TWA configuration)

### TECHNICAL DESIGN

#### Database Schema Required
```sql
-- App store analytics tracking
CREATE TABLE app_store_metrics (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  date DATE NOT NULL,
  store_platform TEXT CHECK (store_platform IN ('microsoft', 'google_play', 'apple')),
  downloads INTEGER DEFAULT 0,
  app_store_views INTEGER DEFAULT 0,
  conversion_rate DECIMAL(5,4),
  average_rating DECIMAL(3,2),
  review_count INTEGER DEFAULT 0,
  revenue DECIMAL(10,2) DEFAULT 0,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- App store review management
CREATE TABLE app_store_reviews (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  store_platform TEXT NOT NULL,
  reviewer_name TEXT,
  rating INTEGER CHECK (rating >= 1 AND rating <= 5),
  review_text TEXT,
  review_date DATE,
  response_text TEXT,
  responded_at TIMESTAMPTZ,
  responded_by UUID REFERENCES users(id)
);
```

#### API Endpoints Required
```typescript
// GET /api/app-store/metadata
interface AppStoreMetadataRequest {
  platform: 'microsoft' | 'google_play' | 'apple';
  locale?: string;
}

interface AppStoreMetadataResponse {
  success: boolean;
  data: {
    title: string;
    subtitle: string;
    description: string;
    keywords: string[];
    screenshots: Screenshot[];
    iconUrls: IconSet;
  };
}
```

#### Frontend Components Required
```typescript
// Component: AppStoreAssetGenerator
// Location: /src/components/admin/AppStoreAssetGenerator.tsx

interface Props {
  platform: 'ios' | 'android' | 'microsoft';
  assetType: 'screenshots' | 'icons' | 'metadata';
}

// Key functionality:
- Automated screenshot generation for different device sizes
- Icon generation in all required resolutions and formats
- Metadata optimization with keyword analysis and character limits
- Asset validation against platform requirements
```

#### Integration Points
```typescript
// Service: AppStoreOptimizer
// Dependencies: Image processing, PWA manifest, metadata generation

class AppStoreOptimizer {
  async generatePlatformAssets(platform: StorePlatform): Promise<AssetBundle> {
    // Generate optimized screenshots, icons, and metadata for specific platform
  }
  
  async validateStoreRequirements(platform: StorePlatform): Promise<ValidationResult> {
    // Ensure all assets meet platform-specific requirements
  }
}
```

### CODE EXAMPLES

#### Example 1: Enhanced PWA Manifest for Stores
```typescript
// ACTUAL CODE PATTERN TO FOLLOW:
import { ManifestOptions } from 'next-pwa';

export const appStoreManifest: ManifestOptions = {
  name: "WedSync - Wedding Vendor Platform",
  short_name: "WedSync",
  description: "Professional wedding vendor management platform for photographers, venues, and planners",
  categories: ["business", "productivity"],
  iarc_rating_id: "e84b8d71-ff39-4c75-b6e3-23f3bcb7bcac",
  screenshots: [
    {
      src: "/store-assets/screenshots/desktop-dashboard.png",
      sizes: "1280x800",
      type: "image/png",
      platform: "wide"
    },
    {
      src: "/store-assets/screenshots/mobile-client-list.png", 
      sizes: "750x1334",
      type: "image/png",
      platform: "narrow"
    }
  ],
  icons: [
    {
      src: "/store-assets/icons/icon-512.png",
      sizes: "512x512",
      type: "image/png",
      purpose: "any"
    }
  ]
};
```

### MCP SERVER USAGE

#### Required MCP Servers
- [x] Context7: Load docs for PWA manifest standards, app store APIs
- [x] Filesystem: Generate and organize store assets in required directory structure
- [x] Playwright: Automate screenshot generation for different viewport sizes

#### Context7 Queries Needed
```typescript
await mcp__context7__get-library-docs("/capacitor/capacitor", "app store deployment", 4000);
await mcp__context7__get-library-docs("/next-pwa/next-pwa", "manifest optimization", 3000);
```

### TEST REQUIREMENTS

#### Unit Tests Required
```typescript
describe('AppStoreOptimizer', () => {
  it('should generate screenshots in all required iOS sizes', () => {
    // Test screenshot generation for iPhone 6.7", 6.5", iPad etc.
  });
  
  it('should validate manifest against Microsoft Store requirements', () => {
    // Test manifest validation for store compliance
  });
});
```

#### E2E Tests Required
```typescript
// Using Playwright MCP
test('PWA meets app store technical requirements', async () => {
  await mcp__playwright__browser_navigate({url: 'https://wedsync.app'});
  await mcp__playwright__browser_resize({width: 1290, height: 2796}); // iPhone size
  await mcp__playwright__browser_take_screenshot({filename: 'store-screenshot-iphone.png'});
  // Verify PWA installation and functionality
});
```

### ACCEPTANCE CRITERIA
- [x] PWA manifest includes all required metadata for Microsoft Store submission
- [x] Screenshots generated for all required device sizes (iPhone, iPad, Android)
- [x] App store descriptions optimized with relevant keywords under character limits
- [x] Performance: PWA loads within 2 seconds on app store review devices
- [x] Security: Privacy policy and terms of service accessible via HTTPS
- [x] Accessibility: App store assets include alt text and screen reader compatibility

### DEPENDENCIES
- Must complete after: PWA configuration foundation and responsive design system
- Must complete before: Marketing launch campaigns and user acquisition strategies
- Shares code with: PWA infrastructure and mobile optimization systems

### ESTIMATED EFFORT
- Team A Frontend: 40 hours (Asset generation tools, screenshot automation, metadata optimization)
- Team B Backend: 16 hours (Store analytics tracking, review management API)
- Team C Integration: 24 hours (Store submission pipelines, TWA/Capacitor configuration)
- Total: 80 hours