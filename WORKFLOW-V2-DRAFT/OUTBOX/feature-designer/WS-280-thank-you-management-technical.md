# TECHNICAL SPECIFICATION: WS-280 - Thank You Management System
## Generated by Feature Development Session - 2025-01-20

### USER STORY & BUSINESS CONTEXT (FACTUAL)
**As a:** Newly married couple managing post-wedding thank you notes
**I want to:** Track which vendors and guests I've thanked and what gifts were received
**So that:** I don't accidentally miss anyone or send duplicate thank you messages during the overwhelming post-wedding period

**Real Wedding Scenario:**
After their wedding, couples typically need to send 50-200+ thank you notes to vendors, guests, and gift-givers. Currently, couples use spreadsheets or handwritten lists to track who they've thanked, often losing track and either missing people or sending duplicates. With this system, they can track thank you status, gift details, and preferred contact methods in one organized place.

### SPECIFICATION SOURCE
- **Feature ID:** WS-280
- **Original Spec:** Post-wedding relationship management and gratitude tracking requirements
- **Current Implementation:** 0% complete
- **Files to Modify:** 
  - `/src/components/dashboard/WeddingDashboard.tsx`
  - `/src/app/api/wedding/[id]/route.ts`
- **New Files to Create:**
  - `/src/components/thank-you/ThankYouManager.tsx`
  - `/src/components/thank-you/ThankYouTracker.tsx`
  - `/src/components/thank-you/GiftRegistry.tsx`
  - `/src/app/api/thank-you/route.ts`
  - `/src/app/api/thank-you/[id]/route.ts`
  - `/src/app/(dashboard)/thank-you/page.tsx`
  - `/src/lib/thank-you/thank-you-service.ts`

### TECHNICAL DESIGN

#### Database Schema Required
```sql
-- Thank you tracking for vendors and guests
CREATE TABLE IF NOT EXISTS thank_you_recipients (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  wedding_id UUID REFERENCES weddings(id) ON DELETE CASCADE,
  recipient_type VARCHAR(20) NOT NULL CHECK (recipient_type IN ('vendor', 'guest', 'family', 'friend')),
  recipient_name VARCHAR(200) NOT NULL,
  recipient_email VARCHAR(255),
  recipient_phone VARCHAR(50),
  recipient_address TEXT,
  vendor_id UUID REFERENCES vendors(id), -- If recipient is a vendor
  guest_id UUID REFERENCES guests(id),   -- If recipient is a guest
  relationship VARCHAR(100), -- "photographer", "maid of honor", "college friend", etc.
  thank_you_reason VARCHAR(200), -- "photography services", "wedding gift", "helping with setup"
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Gift tracking for wedding presents
CREATE TABLE IF NOT EXISTS wedding_gifts (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  wedding_id UUID REFERENCES weddings(id) ON DELETE CASCADE,
  giver_id UUID REFERENCES thank_you_recipients(id),
  gift_description TEXT NOT NULL,
  gift_category VARCHAR(50), -- "household", "experience", "monetary", "handmade"
  monetary_value DECIMAL(10,2),
  gift_date DATE,
  notes TEXT,
  photo_url TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Thank you tracking and status
CREATE TABLE IF NOT EXISTS thank_you_notes (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  wedding_id UUID REFERENCES weddings(id) ON DELETE CASCADE,
  recipient_id UUID REFERENCES thank_you_recipients(id) ON DELETE CASCADE,
  gift_id UUID REFERENCES wedding_gifts(id), -- NULL if thanking for service, not gift
  thank_you_type VARCHAR(20) NOT NULL CHECK (thank_you_type IN ('note', 'email', 'call', 'in_person', 'text')),
  status VARCHAR(20) DEFAULT 'pending' CHECK (status IN ('pending', 'drafted', 'sent', 'delivered', 'acknowledged')),
  message_template VARCHAR(50), -- Reference to template used
  personalized_message TEXT,
  sent_date DATE,
  delivery_method VARCHAR(50), -- "mail", "email", "hand_delivered", "digital"
  delivery_address TEXT,
  tracking_number VARCHAR(100), -- For mailed cards
  cost DECIMAL(8,2), -- Postage or card cost
  notes TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Thank you message templates
CREATE TABLE IF NOT EXISTS thank_you_templates (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  template_name VARCHAR(100) NOT NULL,
  recipient_type VARCHAR(20) NOT NULL,
  template_category VARCHAR(50), -- "vendor_service", "monetary_gift", "physical_gift", "attendance"
  subject_line VARCHAR(200),
  message_template TEXT NOT NULL,
  is_default BOOLEAN DEFAULT FALSE,
  created_by UUID REFERENCES auth.users(id),
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Indexes for performance
CREATE INDEX idx_thank_you_recipients_wedding ON thank_you_recipients(wedding_id, recipient_type);
CREATE INDEX idx_wedding_gifts_giver ON wedding_gifts(giver_id);
CREATE INDEX idx_thank_you_notes_status ON thank_you_notes(wedding_id, status);
CREATE INDEX idx_thank_you_notes_recipient ON thank_you_notes(recipient_id);
```

#### API Endpoints Required
```typescript
// POST /api/thank-you/recipients - Add recipient to thank you list
interface AddRecipientRequest {
  weddingId: string;
  recipientType: 'vendor' | 'guest' | 'family' | 'friend';
  recipientName: string;
  recipientEmail?: string;
  recipientPhone?: string;
  recipientAddress?: string;
  vendorId?: string;
  guestId?: string;
  relationship?: string;
  thankYouReason: string;
}

interface AddRecipientResponse {
  success: boolean;
  recipientId: string;
}

// POST /api/thank-you/gifts - Record a wedding gift
interface RecordGiftRequest {
  weddingId: string;
  giverId: string;
  giftDescription: string;
  giftCategory: 'household' | 'experience' | 'monetary' | 'handmade';
  monetaryValue?: number;
  giftDate?: string;
  notes?: string;
  photoUrl?: string;
}

// GET /api/thank-you?weddingId=x - Get all thank you recipients and status
interface ThankYouListResponse {
  recipients: {
    id: string;
    recipientName: string;
    recipientType: string;
    relationship: string;
    thankYouReason: string;
    gifts: {
      id: string;
      description: string;
      category: string;
      value: number;
    }[];
    thankYouStatus: 'pending' | 'drafted' | 'sent' | 'delivered';
    lastContactDate: string | null;
  }[];
  summary: {
    totalRecipients: number;
    pending: number;
    completed: number;
    totalGiftValue: number;
  };
}

// POST /api/thank-you/[id]/send - Send thank you note
interface SendThankYouRequest {
  recipientId: string;
  giftId?: string;
  thankYouType: 'note' | 'email' | 'call' | 'in_person' | 'text';
  messageTemplate?: string;
  personalizedMessage: string;
  deliveryMethod: 'mail' | 'email' | 'hand_delivered' | 'digital';
  deliveryAddress?: string;
}

// PUT /api/thank-you/notes/[id]/status - Update thank you status
interface UpdateStatusRequest {
  status: 'pending' | 'drafted' | 'sent' | 'delivered' | 'acknowledged';
  trackingNumber?: string;
  deliveryDate?: string;
  cost?: number;
  notes?: string;
}
```

#### Frontend Components Required
```typescript
// Component: ThankYouManager
// Location: /src/components/thank-you/ThankYouManager.tsx

interface ThankYouManagerProps {
  weddingId: string;
  isPostWedding: boolean; // Show different UI based on wedding status
}

// Key functionality:
- Overview dashboard with completion statistics
- Recipient list with status tracking
- Quick actions (mark as sent, add notes)
- Filter and search recipients
- Export thank you list to CSV/PDF

// Component: ThankYouTracker  
// Location: /src/components/thank-you/ThankYouTracker.tsx
interface ThankYouTrackerProps {
  recipients: ThankYouRecipient[];
  onUpdateStatus: (recipientId: string, status: ThankYouStatus) => void;
  onSendThankYou: (recipientId: string, data: SendThankYouData) => void;
}

// Key functionality:
- Table/grid view of all recipients
- Status indicators and progress bars
- Quick status updates (sent, delivered)
- Bulk operations (mark multiple as sent)
- Sort by priority, date, category

// Component: GiftRegistry
// Location: /src/components/thank-you/GiftRegistry.tsx
interface GiftRegistryProps {
  weddingId: string;
  gifts: WeddingGift[];
  onAddGift: (gift: GiftData) => void;
  onEditGift: (giftId: string, updates: GiftUpdates) => void;
}

// Key functionality:
- Add/edit gift details with photos
- Link gifts to thank you recipients
- Gift value tracking and totals
- Gift category organization
- Photo upload for gift documentation

// Component: ThankYouComposer
// Location: /src/components/thank-you/ThankYouComposer.tsx
interface ThankYouComposerProps {
  recipientId: string;
  recipient: ThankYouRecipient;
  gifts: WeddingGift[];
  templates: ThankYouTemplate[];
  onSend: (data: SendThankYouData) => void;
}

// Key functionality:
- Template selection and customization
- Personalized message editing
- Preview thank you note formatting
- Delivery method selection
- Cost tracking for mailed notes
```

#### Integration Points
```typescript
// Service: ThankYouService
// Dependencies: Email service, notification service, guest management

class ThankYouService {
  async importFromGuestList(weddingId: string): Promise<ImportResult> {
    // Import guests who attended as potential thank you recipients
    // Filter out vendors (they have separate workflow)
    // Set up default thank you reasons based on guest data
  }
  
  async importFromVendorList(weddingId: string): Promise<ImportResult> {
    // Import wedding vendors as thank you recipients
    // Include service details as thank you reasons
    // Set up vendor-specific message templates
  }
  
  async generateThankYouDashboard(weddingId: string): Promise<ThankYouDashboard> {
    // Calculate completion statistics
    // Identify overdue thank you notes
    // Generate priority recommendations
  }
  
  async sendThankYou(thankYouData: SendThankYouRequest): Promise<SendResult> {
    // Send thank you via selected method (email, physical mail)
    // Track delivery status and costs
    // Update completion status
  }
}

// Service: ThankYouTemplateService
// Dependencies: Message templating, personalization service

class ThankYouTemplateService {
  async getTemplatesForRecipient(recipientType: string, giftCategory?: string): Promise<ThankYouTemplate[]> {
    // Get appropriate templates based on recipient and gift type
    // Include default templates and custom ones
  }
  
  async personalizeMessage(template: string, recipient: ThankYouRecipient, gift?: WeddingGift): Promise<string> {
    // Replace template variables with actual data
    // Handle gift-specific vs service-specific messaging
    // Ensure proper tone and personalization
  }
}
```

### CODE EXAMPLES

#### Example 1: Thank You Manager Component
```typescript
// ACTUAL CODE PATTERN TO FOLLOW:
'use client';
import { useState, useEffect } from 'react';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';
import { Progress } from '@/components/ui/progress';
import { PlusCircle, CheckCircle, Clock, Mail } from 'lucide-react';

interface ThankYouRecipient {
  id: string;
  recipientName: string;
  recipientType: 'vendor' | 'guest' | 'family' | 'friend';
  relationship: string;
  thankYouReason: string;
  status: 'pending' | 'drafted' | 'sent' | 'delivered' | 'acknowledged';
  gifts: WeddingGift[];
  lastContactDate: string | null;
}

interface ThankYouSummary {
  totalRecipients: number;
  pending: number;
  completed: number;
  totalGiftValue: number;
}

export function ThankYouManager({ weddingId, isPostWedding }: ThankYouManagerProps) {
  const [recipients, setRecipients] = useState<ThankYouRecipient[]>([]);
  const [summary, setSummary] = useState<ThankYouSummary | null>(null);
  const [isLoading, setIsLoading] = useState(true);
  const [filter, setFilter] = useState<'all' | 'pending' | 'completed'>('all');
  const [showAddModal, setShowAddModal] = useState(false);

  useEffect(() => {
    loadThankYouData();
  }, [weddingId]);

  const loadThankYouData = async () => {
    try {
      const response = await fetch(`/api/thank-you?weddingId=${weddingId}`);
      const data = await response.json();
      
      setRecipients(data.recipients || []);
      setSummary(data.summary);
    } catch (error) {
      console.error('Error loading thank you data:', error);
    } finally {
      setIsLoading(false);
    }
  };

  const importFromGuestList = async () => {
    try {
      const response = await fetch('/api/thank-you/import/guests', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ weddingId })
      });

      if (response.ok) {
        const result = await response.json();
        alert(`Imported ${result.imported} guests as thank you recipients`);
        await loadThankYouData();
      }
    } catch (error) {
      console.error('Error importing guests:', error);
    }
  };

  const importFromVendors = async () => {
    try {
      const response = await fetch('/api/thank-you/import/vendors', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ weddingId })
      });

      if (response.ok) {
        const result = await response.json();
        alert(`Imported ${result.imported} vendors as thank you recipients`);
        await loadThankYouData();
      }
    } catch (error) {
      console.error('Error importing vendors:', error);
    }
  };

  const updateRecipientStatus = async (recipientId: string, status: string) => {
    try {
      const response = await fetch(`/api/thank-you/${recipientId}/status`, {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ status })
      });

      if (response.ok) {
        setRecipients(prev => 
          prev.map(r => 
            r.id === recipientId ? { ...r, status: status as any } : r
          )
        );
        
        // Update summary
        await loadThankYouData();
      }
    } catch (error) {
      console.error('Error updating status:', error);
    }
  };

  const getFilteredRecipients = () => {
    switch (filter) {
      case 'pending':
        return recipients.filter(r => !['sent', 'delivered', 'acknowledged'].includes(r.status));
      case 'completed':
        return recipients.filter(r => ['sent', 'delivered', 'acknowledged'].includes(r.status));
      default:
        return recipients;
    }
  };

  const getStatusBadgeVariant = (status: string) => {
    switch (status) {
      case 'pending': return 'destructive';
      case 'drafted': return 'warning';
      case 'sent': return 'info';
      case 'delivered': return 'success';
      case 'acknowledged': return 'success';
      default: return 'secondary';
    }
  };

  const getStatusIcon = (status: string) => {
    switch (status) {
      case 'pending': return <Clock className="w-4 h-4" />;
      case 'sent': return <Mail className="w-4 h-4" />;
      case 'delivered':
      case 'acknowledged':
        return <CheckCircle className="w-4 h-4" />;
      default: return null;
    }
  };

  if (isLoading) {
    return <div className="animate-pulse p-8">Loading thank you manager...</div>;
  }

  const completionPercentage = summary ? Math.round((summary.completed / summary.totalRecipients) * 100) : 0;

  return (
    <div className="space-y-6">
      {/* Summary Dashboard */}
      <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
        <Card>
          <CardContent className="p-6">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-sm text-gray-600">Total Recipients</p>
                <p className="text-2xl font-bold">{summary?.totalRecipients || 0}</p>
              </div>
              <PlusCircle className="w-8 h-8 text-blue-600" />
            </div>
          </CardContent>
        </Card>

        <Card>
          <CardContent className="p-6">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-sm text-gray-600">Pending</p>
                <p className="text-2xl font-bold text-orange-600">{summary?.pending || 0}</p>
              </div>
              <Clock className="w-8 h-8 text-orange-600" />
            </div>
          </CardContent>
        </Card>

        <Card>
          <CardContent className="p-6">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-sm text-gray-600">Completed</p>
                <p className="text-2xl font-bold text-green-600">{summary?.completed || 0}</p>
              </div>
              <CheckCircle className="w-8 h-8 text-green-600" />
            </div>
          </CardContent>
        </Card>

        <Card>
          <CardContent className="p-6">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-sm text-gray-600">Gift Value</p>
                <p className="text-2xl font-bold">${summary?.totalGiftValue?.toLocaleString() || 0}</p>
              </div>
              <Mail className="w-8 h-8 text-purple-600" />
            </div>
          </CardContent>
        </Card>
      </div>

      {/* Progress Overview */}
      <Card>
        <CardHeader>
          <CardTitle className="flex items-center justify-between">
            <span>Thank You Progress</span>
            <span className="text-lg">{completionPercentage}% Complete</span>
          </CardTitle>
        </CardHeader>
        <CardContent>
          <Progress value={completionPercentage} className="h-3" />
          <div className="flex justify-between text-sm text-gray-600 mt-2">
            <span>{summary?.completed || 0} sent</span>
            <span>{summary?.pending || 0} remaining</span>
          </div>
        </CardContent>
      </Card>

      {/* Quick Actions */}
      <div className="flex flex-wrap gap-4">
        <Button onClick={importFromGuestList} variant="outline">
          Import from Guest List
        </Button>
        <Button onClick={importFromVendors} variant="outline">
          Import from Vendors
        </Button>
        <Button onClick={() => setShowAddModal(true)}>
          Add Individual Recipient
        </Button>
      </div>

      {/* Filter Tabs */}
      <div className="flex space-x-2">
        {[
          { key: 'all', label: 'All Recipients' },
          { key: 'pending', label: 'Pending' },
          { key: 'completed', label: 'Completed' }
        ].map(tab => (
          <Button
            key={tab.key}
            variant={filter === tab.key ? 'default' : 'outline'}
            onClick={() => setFilter(tab.key as any)}
          >
            {tab.label}
          </Button>
        ))}
      </div>

      {/* Recipients List */}
      <div className="space-y-4">
        {getFilteredRecipients().map(recipient => (
          <Card key={recipient.id} className="hover:shadow-md transition-shadow">
            <CardContent className="p-6">
              <div className="flex items-center justify-between">
                <div className="flex-1">
                  <div className="flex items-center space-x-3 mb-2">
                    <h3 className="font-semibold text-lg">{recipient.recipientName}</h3>
                    <Badge variant={getStatusBadgeVariant(recipient.status)} className="flex items-center space-x-1">
                      {getStatusIcon(recipient.status)}
                      <span>{recipient.status.charAt(0).toUpperCase() + recipient.status.slice(1)}</span>
                    </Badge>
                  </div>
                  
                  <div className="text-sm text-gray-600 space-y-1">
                    <p><strong>Relationship:</strong> {recipient.relationship}</p>
                    <p><strong>Thank you for:</strong> {recipient.thankYouReason}</p>
                    {recipient.gifts.length > 0 && (
                      <p><strong>Gifts:</strong> {recipient.gifts.map(g => g.description).join(', ')}</p>
                    )}
                  </div>
                </div>

                <div className="flex items-center space-x-2">
                  {recipient.status === 'pending' && (
                    <>
                      <Button
                        size="sm"
                        variant="outline"
                        onClick={() => updateRecipientStatus(recipient.id, 'drafted')}
                      >
                        Draft Note
                      </Button>
                      <Button
                        size="sm"
                        onClick={() => updateRecipientStatus(recipient.id, 'sent')}
                      >
                        Mark as Sent
                      </Button>
                    </>
                  )}
                  
                  {recipient.status === 'sent' && (
                    <Button
                      size="sm"
                      variant="outline"
                      onClick={() => updateRecipientStatus(recipient.id, 'delivered')}
                    >
                      Mark as Delivered
                    </Button>
                  )}

                  <Button size="sm" variant="ghost">
                    View Details
                  </Button>
                </div>
              </div>
            </CardContent>
          </Card>
        ))}
      </div>

      {getFilteredRecipients().length === 0 && (
        <Card>
          <CardContent className="p-12 text-center">
            <Mail className="w-12 h-12 text-gray-400 mx-auto mb-4" />
            <h3 className="text-lg font-medium text-gray-900 mb-2">
              {filter === 'all' ? 'No recipients yet' : `No ${filter} recipients`}
            </h3>
            <p className="text-gray-600 mb-4">
              {isPostWedding 
                ? "Import your guests and vendors to start tracking thank you notes."
                : "You can set up your thank you list now or wait until after the wedding."
              }
            </p>
            {filter === 'all' && (
              <div className="space-x-4">
                <Button onClick={importFromGuestList}>Import from Guest List</Button>
                <Button onClick={importFromVendors} variant="outline">Import from Vendors</Button>
              </div>
            )}
          </CardContent>
        </Card>
      )}
    </div>
  );
}
```

#### Example 2: Gift Registry Component
```typescript
'use client';
import { useState, useEffect } from 'react';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Textarea } from '@/components/ui/textarea';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';
import { Gift, DollarSign, Camera } from 'lucide-react';

interface WeddingGift {
  id: string;
  giverId: string;
  giverName: string;
  giftDescription: string;
  giftCategory: 'household' | 'experience' | 'monetary' | 'handmade';
  monetaryValue: number;
  giftDate: string;
  notes: string;
  photoUrl: string | null;
}

export function GiftRegistry({ weddingId, gifts, onAddGift, onEditGift }: GiftRegistryProps) {
  const [showAddModal, setShowAddModal] = useState(false);
  const [editingGift, setEditingGift] = useState<WeddingGift | null>(null);
  const [formData, setFormData] = useState({
    giverId: '',
    giftDescription: '',
    giftCategory: 'household' as const,
    monetaryValue: '',
    giftDate: '',
    notes: '',
    photoUrl: ''
  });
  const [recipients, setRecipients] = useState<any[]>([]);

  useEffect(() => {
    loadRecipients();
  }, [weddingId]);

  const loadRecipients = async () => {
    try {
      const response = await fetch(`/api/thank-you/recipients?weddingId=${weddingId}`);
      const data = await response.json();
      setRecipients(data.recipients || []);
    } catch (error) {
      console.error('Error loading recipients:', error);
    }
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    
    const giftData = {
      weddingId,
      giverId: formData.giverId,
      giftDescription: formData.giftDescription,
      giftCategory: formData.giftCategory,
      monetaryValue: parseFloat(formData.monetaryValue) || 0,
      giftDate: formData.giftDate,
      notes: formData.notes,
      photoUrl: formData.photoUrl || null
    };

    if (editingGift) {
      await onEditGift(editingGift.id, giftData);
    } else {
      await onAddGift(giftData);
    }

    resetForm();
    setShowAddModal(false);
    setEditingGift(null);
  };

  const resetForm = () => {
    setFormData({
      giverId: '',
      giftDescription: '',
      giftCategory: 'household',
      monetaryValue: '',
      giftDate: '',
      notes: '',
      photoUrl: ''
    });
  };

  const openEditModal = (gift: WeddingGift) => {
    setEditingGift(gift);
    setFormData({
      giverId: gift.giverId,
      giftDescription: gift.giftDescription,
      giftCategory: gift.giftCategory,
      monetaryValue: gift.monetaryValue.toString(),
      giftDate: gift.giftDate,
      notes: gift.notes,
      photoUrl: gift.photoUrl || ''
    });
    setShowAddModal(true);
  };

  const totalGiftValue = gifts.reduce((sum, gift) => sum + gift.monetaryValue, 0);
  const giftsByCategory = gifts.reduce((acc, gift) => {
    acc[gift.giftCategory] = (acc[gift.giftCategory] || 0) + 1;
    return acc;
  }, {} as Record<string, number>);

  const categoryColors = {
    household: 'bg-blue-100 text-blue-800',
    experience: 'bg-purple-100 text-purple-800',
    monetary: 'bg-green-100 text-green-800',
    handmade: 'bg-orange-100 text-orange-800'
  };

  return (
    <div className="space-y-6">
      {/* Gift Summary */}
      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
        <Card>
          <CardContent className="p-6">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-sm text-gray-600">Total Gifts</p>
                <p className="text-2xl font-bold">{gifts.length}</p>
              </div>
              <Gift className="w-8 h-8 text-blue-600" />
            </div>
          </CardContent>
        </Card>

        <Card>
          <CardContent className="p-6">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-sm text-gray-600">Total Value</p>
                <p className="text-2xl font-bold">${totalGiftValue.toLocaleString()}</p>
              </div>
              <DollarSign className="w-8 h-8 text-green-600" />
            </div>
          </CardContent>
        </Card>

        <Card>
          <CardContent className="p-6">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-sm text-gray-600">With Photos</p>
                <p className="text-2xl font-bold">{gifts.filter(g => g.photoUrl).length}</p>
              </div>
              <Camera className="w-8 h-8 text-purple-600" />
            </div>
          </CardContent>
        </Card>
      </div>

      {/* Category Breakdown */}
      <Card>
        <CardHeader>
          <CardTitle>Gift Categories</CardTitle>
        </CardHeader>
        <CardContent>
          <div className="flex flex-wrap gap-2">
            {Object.entries(giftsByCategory).map(([category, count]) => (
              <span
                key={category}
                className={`px-3 py-1 rounded-full text-sm font-medium ${categoryColors[category as keyof typeof categoryColors]}`}
              >
                {category.charAt(0).toUpperCase() + category.slice(1)}: {count}
              </span>
            ))}
          </div>
        </CardContent>
      </Card>

      {/* Add Gift Button */}
      <div className="flex justify-between items-center">
        <h2 className="text-xl font-semibold">Wedding Gifts</h2>
        <Button onClick={() => setShowAddModal(true)}>
          Add Gift
        </Button>
      </div>

      {/* Gifts List */}
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        {gifts.map(gift => (
          <Card key={gift.id} className="hover:shadow-md transition-shadow cursor-pointer" 
                onClick={() => openEditModal(gift)}>
            <CardContent className="p-4">
              {gift.photoUrl && (
                <img 
                  src={gift.photoUrl} 
                  alt={gift.giftDescription}
                  className="w-full h-32 object-cover rounded mb-3"
                />
              )}
              
              <div className="space-y-2">
                <div className="flex items-center justify-between">
                  <span className={`px-2 py-1 rounded text-xs font-medium ${categoryColors[gift.giftCategory]}`}>
                    {gift.giftCategory.charAt(0).toUpperCase() + gift.giftCategory.slice(1)}
                  </span>
                  {gift.monetaryValue > 0 && (
                    <span className="text-sm font-semibold text-green-600">
                      ${gift.monetaryValue}
                    </span>
                  )}
                </div>
                
                <h3 className="font-medium">{gift.giftDescription}</h3>
                <p className="text-sm text-gray-600">From: {gift.giverName}</p>
                
                {gift.notes && (
                  <p className="text-sm text-gray-500 italic">{gift.notes}</p>
                )}
                
                {gift.giftDate && (
                  <p className="text-xs text-gray-400">
                    Received: {new Date(gift.giftDate).toLocaleDateString()}
                  </p>
                )}
              </div>
            </CardContent>
          </Card>
        ))}
      </div>

      {gifts.length === 0 && (
        <Card>
          <CardContent className="p-12 text-center">
            <Gift className="w-12 h-12 text-gray-400 mx-auto mb-4" />
            <h3 className="text-lg font-medium text-gray-900 mb-2">No gifts recorded yet</h3>
            <p className="text-gray-600 mb-4">
              Start tracking your wedding gifts to make thank you notes easier.
            </p>
            <Button onClick={() => setShowAddModal(true)}>Add Your First Gift</Button>
          </CardContent>
        </Card>
      )}

      {/* Add/Edit Gift Modal */}
      <Dialog open={showAddModal} onOpenChange={(open) => {
        setShowAddModal(open);
        if (!open) {
          setEditingGift(null);
          resetForm();
        }
      }}>
        <DialogContent className="sm:max-w-md">
          <DialogHeader>
            <DialogTitle>{editingGift ? 'Edit Gift' : 'Add Wedding Gift'}</DialogTitle>
          </DialogHeader>
          
          <form onSubmit={handleSubmit} className="space-y-4">
            <div>
              <label className="text-sm font-medium">Gift Giver</label>
              <Select value={formData.giverId} onValueChange={(value) => setFormData(prev => ({ ...prev, giverId: value }))}>
                <SelectTrigger>
                  <SelectValue placeholder="Select gift giver" />
                </SelectTrigger>
                <SelectContent>
                  {recipients.map(recipient => (
                    <SelectItem key={recipient.id} value={recipient.id}>
                      {recipient.recipientName}
                    </SelectItem>
                  ))}
                </SelectContent>
              </Select>
            </div>

            <div>
              <label className="text-sm font-medium">Gift Description</label>
              <Input
                value={formData.giftDescription}
                onChange={(e) => setFormData(prev => ({ ...prev, giftDescription: e.target.value }))}
                placeholder="e.g., Kitchen Aid Mixer, Honeymoon Fund, Handmade Quilt"
                required
              />
            </div>

            <div>
              <label className="text-sm font-medium">Category</label>
              <Select value={formData.giftCategory} onValueChange={(value) => setFormData(prev => ({ ...prev, giftCategory: value as any }))}>
                <SelectTrigger>
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="household">Household Items</SelectItem>
                  <SelectItem value="experience">Experience/Money</SelectItem>
                  <SelectItem value="monetary">Cash/Check</SelectItem>
                  <SelectItem value="handmade">Handmade/Personal</SelectItem>
                </SelectContent>
              </Select>
            </div>

            <div className="grid grid-cols-2 gap-4">
              <div>
                <label className="text-sm font-medium">Value ($)</label>
                <Input
                  type="number"
                  step="0.01"
                  value={formData.monetaryValue}
                  onChange={(e) => setFormData(prev => ({ ...prev, monetaryValue: e.target.value }))}
                  placeholder="0.00"
                />
              </div>
              
              <div>
                <label className="text-sm font-medium">Date Received</label>
                <Input
                  type="date"
                  value={formData.giftDate}
                  onChange={(e) => setFormData(prev => ({ ...prev, giftDate: e.target.value }))}
                />
              </div>
            </div>

            <div>
              <label className="text-sm font-medium">Photo URL</label>
              <Input
                value={formData.photoUrl}
                onChange={(e) => setFormData(prev => ({ ...prev, photoUrl: e.target.value }))}
                placeholder="Optional: Link to gift photo"
              />
            </div>

            <div>
              <label className="text-sm font-medium">Notes</label>
              <Textarea
                value={formData.notes}
                onChange={(e) => setFormData(prev => ({ ...prev, notes: e.target.value }))}
                placeholder="Any additional details about the gift..."
                rows={3}
              />
            </div>

            <div className="flex justify-between">
              <Button type="button" variant="outline" onClick={() => setShowAddModal(false)}>
                Cancel
              </Button>
              <Button type="submit">
                {editingGift ? 'Update Gift' : 'Add Gift'}
              </Button>
            </div>
          </form>
        </DialogContent>
      </Dialog>
    </div>
  );
}
```

### MCP SERVER USAGE

#### Required MCP Servers
- [x] Ref MCP: Search docs for React form patterns, gift tracking systems
- [x] Supabase MCP: Database operations and user management  
- [x] Browser MCP: Interactive testing of gift registry and thank you interface
- [x] Filesystem: Access thank you templates and styling

#### Ref MCP Searches Needed
```bash
# Use Ref MCP to search for:
# - "React gift registry patterns"
# - "Thank you note management systems"
# - "Post-wedding task management"
# - "Wedding gratitude tracking best practices"
```

#### Browser MCP Interactive Testing
```bash
# Use Browser MCP for:
# - Testing thank you status updates
# - Verifying gift registry functionality
# - Screenshot capture of management interface
# - Testing mobile responsive thank you tracking
```

### TEST REQUIREMENTS

#### Unit Tests Required
```typescript
describe('ThankYouManager', () => {
  it('should load recipients and calculate summary correctly', async () => {
    // Test recipient loading and summary calculations
  });
  
  it('should import guests and vendors as recipients', async () => {
    // Test import functionality from guest and vendor lists
  });
  
  it('should update recipient status correctly', async () => {
    // Test status updates and tracking
  });
  
  it('should filter recipients by status', () => {
    // Test filtering logic for pending/completed recipients
  });
});

describe('GiftRegistry', () => {
  it('should add and edit gifts correctly', async () => {
    // Test gift addition and editing functionality
  });
  
  it('should calculate total gift value correctly', () => {
    // Test gift value calculations and summaries
  });
});
```

#### E2E Tests Required
```typescript
test('Complete thank you management workflow', async () => {
  await mcp__playwright__browser_navigate({url: '/wedding/test-wedding/thank-you'});
  
  // Import guests as recipients
  await mcp__playwright__browser_click({element: 'Import guests button', ref: '[data-testid="import-guests"]'});
  
  // Add a wedding gift
  await mcp__playwright__browser_click({element: 'Add gift button', ref: '[data-testid="add-gift"]'});
  await mcp__playwright__browser_type({element: 'Gift description', ref: '[data-testid="gift-description"]', text: 'Kitchen Aid Mixer'});
  await mcp__playwright__browser_select_option({element: 'Gift category', ref: '[data-testid="gift-category"]', values: ['household']});
  await mcp__playwright__browser_type({element: 'Gift value', ref: '[data-testid="gift-value"]', text: '299.99'});
  await mcp__playwright__browser_click({element: 'Save gift', ref: '[data-testid="save-gift"]'});
  
  // Mark thank you as sent
  await mcp__playwright__browser_click({element: 'Mark as sent button', ref: '[data-testid="mark-sent"]'});
  
  // Verify progress update
  const progress = await page.waitForSelector('[data-testid="completion-progress"]');
  expect(progress).toBeTruthy();
});
```

### ACCEPTANCE CRITERIA
- [x] Users can import guests and vendors as thank you recipients
- [x] Comprehensive gift tracking with photos and values
- [x] Thank you status tracking (pending, sent, delivered, acknowledged)
- [x] Progress dashboard with completion statistics
- [x] Thank you message templates for different recipient types
- [x] Delivery method tracking (mail, email, in-person)
- [x] Cost tracking for postage and cards
- [x] Export functionality for thank you lists
- [x] Mobile-responsive interface for on-the-go updates
- [x] **Navigation Integration: Thank you management accessible from post-wedding dashboard**
  - [x] Thank you tab in main wedding dashboard (post-wedding phase)
  - [x] Progress indicators in navigation for pending thank yous
  - [x] Quick access to gift registry from main menu
  - [x] Mobile navigation support for thank you tracking
  - [x] Integration with post-wedding workflow navigation

### DEPENDENCIES
- Must complete after: Guest management system, vendor management system
- Must complete before: Sharing Controls Enhancement (WS-281)
- Shares code with: Guest list management, vendor management, notification system

### ESTIMATED EFFORT
- Team A Frontend: 36 hours (Thank you UI, gift registry, status tracking, mobile responsive)
- Team B Backend: 24 hours (Thank you APIs, import logic, status management)
- Team C Integration: 8 hours (Guest/vendor import integration)
- Team D Platform: 12 hours (Thank you templates, delivery tracking)
- Team E General: 16 hours (Testing, mobile responsive, export functionality)
- Team F Workflows: 8 hours (Post-wedding workflow integration)
- Team G Performance: 4 hours (List performance optimization)
- Total: 108 hours