# TECHNICAL SPECIFICATION: WS-038 - Navigation Structure
## Generated by Feature Development Session - 2025-08-21

### USER STORY & BUSINESS CONTEXT (THINK HARD - BE FACTUAL)
**As a:** Wedding photographer using WedSync on desktop and mobile throughout the day
**I want to:** Navigate quickly between clients, forms, journeys, and settings with consistent patterns
**So that:** I can access any feature within 2 clicks without getting lost or confused about where I am

**Real Wedding Scenario:**
During a wedding day, a photographer needs to quickly jump between the couple's timeline (journey section), update delivery status (client profile), check other weddings this weekend (dashboard), and access camera card upload (forms section). Clear navigation prevents fumbling through menus when time is critical.

### SPECIFICATION SOURCE
- **Feature ID:** WS-038
- **Original Spec:** /CORE-SPECIFICATIONS/02-WEDSYNC-SUPPLIER-PLATFORM/02-Dashboard/02-navigation-structure md.md
- **Current Implementation:** 0% complete
- **Files to Modify:**
  - `/src/components/layout/Navigation.tsx` (new)
  - `/src/components/layout/Sidebar.tsx` (new)
  - `/src/components/layout/MobileNav.tsx` (new)
- **New Files to Create:**
  - `/src/components/navigation/NavItem.tsx`
  - `/src/components/navigation/Breadcrumbs.tsx`
  - `/src/components/navigation/SearchNav.tsx`

### TECHNICAL DESIGN

#### Database Schema Required
```sql
-- Navigation preferences for customization
CREATE TABLE IF NOT EXISTS navigation_preferences (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  supplier_id UUID REFERENCES suppliers(id) ON DELETE CASCADE,
  sidebar_collapsed BOOLEAN DEFAULT false,
  pinned_items JSONB DEFAULT '[]',
  recent_items JSONB DEFAULT '[]',
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(supplier_id)
);
```

#### Frontend Components Required
```typescript
// Component: Navigation
interface NavigationProps {
  currentPath: string;
  user: User;
}

// Key functionality:
- Responsive design (desktop sidebar, mobile bottom tabs)
- Active state indication
- Keyboard shortcuts (Cmd+1, Cmd+2, etc.)
- Collapsible sidebar
- Search integration (Cmd+K)

// Component: Sidebar
interface SidebarProps {
  isCollapsed: boolean;
  onToggle: () => void;
  currentPath: string;
}

// Key functionality:
- Hierarchical menu structure
- Icons + labels (labels hide when collapsed)
- Hover expand when collapsed
- Drag-and-drop reordering
- Badge counts for notifications

// Component: Breadcrumbs
interface BreadcrumbsProps {
  path: string;
  maxItems?: number;
}

// Key functionality:
- Auto-generated from route structure
- Click to navigate to parent levels
- Responsive truncation
- Client/journey context awareness
```

#### Integration Points
```typescript
// Navigation structure
const NAVIGATION_ITEMS = [
  {
    id: 'dashboard',
    label: 'Dashboard',
    icon: Home,
    path: '/dashboard',
    shortcut: 'Cmd+1'
  },
  {
    id: 'clients',
    label: 'Clients',
    icon: Users,
    path: '/clients',
    shortcut: 'Cmd+2',
    children: [
      { id: 'client-list', label: 'All Clients', path: '/clients' },
      { id: 'client-import', label: 'Import Clients', path: '/clients/import' }
    ]
  },
  {
    id: 'journeys',
    label: 'Customer Journeys',
    icon: Route,
    path: '/journeys',
    shortcut: 'Cmd+3'
  },
  {
    id: 'forms',
    label: 'Forms',
    icon: FileText,
    path: '/forms',
    shortcut: 'Cmd+4'
  },
  {
    id: 'communications',
    label: 'Communications',
    icon: Mail,
    path: '/communications',
    shortcut: 'Cmd+5'
  },
  {
    id: 'settings',
    label: 'Settings',
    icon: Settings,
    path: '/settings',
    shortcut: 'Cmd+,'
  }
];

// Responsive navigation hook
function useNavigation() {
  const [isMobile, setIsMobile] = useState(false);
  const [sidebarCollapsed, setSidebarCollapsed] = useState(false);
  
  useEffect(() => {
    const checkMobile = () => setIsMobile(window.innerWidth < 768);
    checkMobile();
    window.addEventListener('resize', checkMobile);
    return () => window.removeEventListener('resize', checkMobile);
  }, []);
  
  // Keyboard shortcuts
  useEffect(() => {
    const handleKeyboard = (e: KeyboardEvent) => {
      if (e.metaKey || e.ctrlKey) {
        const item = NAVIGATION_ITEMS.find(item => 
          item.shortcut === `${e.metaKey ? 'Cmd' : 'Ctrl'}+${e.key}`
        );
        if (item) {
          e.preventDefault();
          router.push(item.path);
        }
      }
    };
    
    document.addEventListener('keydown', handleKeyboard);
    return () => document.removeEventListener('keydown', handleKeyboard);
  }, []);
  
  return {
    isMobile,
    sidebarCollapsed,
    setSidebarCollapsed,
    navigationItems: NAVIGATION_ITEMS
  };
}
```

### CODE EXAMPLES

#### Example 1: Responsive Navigation Layout
```typescript
// ACTUAL CODE PATTERN TO FOLLOW:
import { useState } from 'react';
import { useRouter } from 'next/navigation';
import { cn } from '@/lib/utils';

interface NavigationLayoutProps {
  children: React.ReactNode;
}

export function NavigationLayout({ children }: NavigationLayoutProps) {
  const { isMobile, sidebarCollapsed, setSidebarCollapsed } = useNavigation();
  const router = useRouter();
  
  return (
    <div className="flex h-screen bg-gray-50">
      {/* Desktop Sidebar */}
      {!isMobile && (
        <aside className={cn(
          "bg-white border-r border-gray-200 transition-all duration-300",
          sidebarCollapsed ? "w-16" : "w-64"
        )}>
          <div className="flex flex-col h-full">
            {/* Logo */}
            <div className="flex items-center h-16 px-4 border-b border-gray-200">
              {!sidebarCollapsed && (
                <img src="/logo.svg" alt="WedSync" className="h-8" />
              )}
              <button
                onClick={() => setSidebarCollapsed(!sidebarCollapsed)}
                className="ml-auto p-2 hover:bg-gray-100 rounded"
              >
                <MenuIcon className="w-4 h-4" />
              </button>
            </div>
            
            {/* Navigation Items */}
            <nav className="flex-1 px-3 py-4 space-y-1 overflow-y-auto">
              {NAVIGATION_ITEMS.map(item => (
                <NavItem
                  key={item.id}
                  item={item}
                  isCollapsed={sidebarCollapsed}
                  isActive={router.pathname.startsWith(item.path)}
                />
              ))}
            </nav>
            
            {/* User Menu */}
            <div className="border-t border-gray-200 p-3">
              <UserMenu isCollapsed={sidebarCollapsed} />
            </div>
          </div>
        </aside>
      )}
      
      {/* Main Content */}
      <main className="flex-1 flex flex-col overflow-hidden">
        {/* Top Bar */}
        <header className="bg-white border-b border-gray-200 h-16 flex items-center px-6">
          {isMobile && <MobileMenuButton />}
          <Breadcrumbs />
          <div className="ml-auto flex items-center gap-4">
            <SearchButton />
            <NotificationButton />
            <UserAvatar />
          </div>
        </header>
        
        {/* Page Content */}
        <div className="flex-1 overflow-auto">
          {children}
        </div>
      </main>
      
      {/* Mobile Bottom Navigation */}
      {isMobile && <MobileBottomNav />}
    </div>
  );
}
```

### ACCEPTANCE CRITERIA
- [x] Consistent navigation on desktop and mobile
- [x] Keyboard shortcuts work for all main sections
- [x] Breadcrumbs show current location context
- [x] Sidebar collapse/expand state persists
- [x] Performance: Navigation renders in <100ms
- [x] Security: Navigation items filtered by user permissions
- [x] Accessibility: ARIA labels, keyboard navigation, focus management

### DEPENDENCIES
- Must complete after: WS-037 (Main Dashboard Layout)
- Must complete before: All other features (provides navigation foundation)
- Shares code with: Layout components, routing utilities

### ESTIMATED EFFORT
- Team A Frontend: 14 hours
- Team B Backend: 4 hours
- Team C Integration: 2 hours
- Total: 20 hours