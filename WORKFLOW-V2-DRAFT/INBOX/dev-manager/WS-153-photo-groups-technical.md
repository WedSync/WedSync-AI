# TECHNICAL SPECIFICATION: WS-153 - Photo Groups Management
## Generated by Feature Development Session - August 23, 2025

### USER STORY & BUSINESS CONTEXT (THINK HARD - BE FACTUAL)
**As a:** Wedding couple organizing photo sessions
**I want to:** Create photo groups from my guest list for efficient photography organization
**So that:** My photographer can efficiently capture all desired group combinations without confusion

**Real Wedding Scenario:**
A couple currently creates handwritten lists like "Family photos: Mom's side, Dad's side, siblings only" leading to missed shots. With this feature, they create groups like "Smith Family (8 people): John Sr., Mary, John Jr., Sarah..." with automatic conflict detection if someone is in overlapping photos scheduled simultaneously.

### SPECIFICATION SOURCE
- **Feature ID:** WS-153
- **Original Spec:** /CORE-SPECIFICATIONS/03-WEDME-COUPLE-PLATFORM/04-Guest-Management/04-photo-groups md.md
- **Current Implementation:** 0% complete (new)
- **Files to Modify:** Extend WS-151 guest management system
- **New Files to Create:** 
  - `/src/components/guests/PhotoGroupManager.tsx`
  - `/src/components/guests/PhotoGroupBuilder.tsx`
  - `/src/lib/services/photoGroupService.ts`

### TECHNICAL DESIGN

#### Database Schema Required
```sql
CREATE TABLE IF NOT EXISTS photo_groups (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  couple_id UUID REFERENCES couples(id),
  name VARCHAR(255) NOT NULL,
  description TEXT,
  shot_type VARCHAR(50) CHECK (shot_type IN ('formal', 'candid', 'posed', 'lifestyle')),
  estimated_duration INTEGER DEFAULT 5, -- minutes
  priority INTEGER DEFAULT 5, -- 1-10 scale
  location_preference VARCHAR(255),
  photographer_notes TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE IF NOT EXISTS photo_group_members (
  photo_group_id UUID REFERENCES photo_groups(id) ON DELETE CASCADE,
  guest_id UUID REFERENCES guests(id) ON DELETE CASCADE,
  PRIMARY KEY (photo_group_id, guest_id)
);

INSERT INTO photo_groups (couple_id, name, description, shot_type, estimated_duration, priority) 
SELECT couples.id, 'Getting Ready', 'Bridal party preparation', 'candid', 30, 8
FROM couples LIMIT 1;
```

#### API Endpoints Required
```typescript
// POST /api/photo-groups
interface CreatePhotoGroupRequest {
  name: string;
  description?: string;
  shot_type: 'formal' | 'candid' | 'posed' | 'lifestyle';
  member_ids: string[];
  estimated_duration?: number;
}

// GET /api/photo-groups/:couple_id
interface PhotoGroupsResponse {
  success: boolean;
  data: {
    groups: PhotoGroup[];
    scheduling_conflicts: Array<{
      group1: string;
      group2: string;
      shared_members: string[];
    }>;
  };
}
```

### CODE EXAMPLES

#### Example 1: Photo Group Manager
```typescript
'use client';

import { useState, useEffect } from 'react';
import { supabase } from '@/lib/supabase';
import { PhotoGroup, Guest } from '@/types/guests';

export function PhotoGroupManager({ 
  coupleId, 
  guests 
}: {
  coupleId: string;
  guests: Guest[];
}) {
  const [photoGroups, setPhotoGroups] = useState<PhotoGroup[]>([]);
  const [selectedMembers, setSelectedMembers] = useState<string[]>([]);

  const createPhotoGroup = async (groupData: any) => {
    const { data, error } = await supabase
      .from('photo_groups')
      .insert({
        couple_id: coupleId,
        ...groupData
      })
      .select()
      .single();

    if (!error) {
      // Add members to group
      const memberInserts = selectedMembers.map(guestId => ({
        photo_group_id: data.id,
        guest_id: guestId
      }));

      await supabase
        .from('photo_group_members')
        .insert(memberInserts);

      setPhotoGroups([...photoGroups, data]);
      setSelectedMembers([]);
    }
  };

  return (
    <div className="photo-group-manager space-y-6">
      <h2 className="text-xl font-semibold">Photo Groups</h2>
      
      {/* Group creation form would go here */}
      <div className="group-builder bg-white p-4 border rounded">
        {/* Form implementation */}
      </div>

      {/* Display existing groups */}
      <div className="groups-list space-y-3">
        {photoGroups.map(group => (
          <div key={group.id} className="group-card bg-white p-4 border rounded">
            <h3 className="font-medium">{group.name}</h3>
            <p className="text-sm text-gray-600">{group.description}</p>
            <div className="text-xs text-gray-500">
              {group.shot_type} â€¢ {group.estimated_duration} min
            </div>
          </div>
        ))}
      </div>
    </div>
  );
}
```

### ACCEPTANCE CRITERIA
- [x] Create photo groups from guest list with drag-and-drop
- [x] Multiple shot types (formal, candid, posed, lifestyle)
- [x] Time estimation for each group photo session
- [x] Conflict detection for overlapping group members
- [x] Export photo shot list for photographer
- [x] Integration with timeline for scheduling photo sessions

### DEPENDENCIES
- Must complete after: WS-151 (Guest List Builder)
- Must complete before: None
- Shares code with: Guest management system

### ESTIMATED EFFORT
- Team A Frontend: 16 hours
- Team B Backend: 12 hours
- Team C Integration: 8 hours
- Total: 36 hours