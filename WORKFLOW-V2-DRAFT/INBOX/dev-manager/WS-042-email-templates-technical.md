# TECHNICAL SPECIFICATION: WS-042 - Email Templates
## Generated by Feature Development Session - 2025-08-21

### USER STORY & BUSINESS CONTEXT (THINK HARD - BE FACTUAL)
**As a:** Wedding photographer who sends similar emails to every couple
**I want to:** Create reusable email templates with merge fields for couple names, dates, and venues
**So that:** I can send professional, personalized emails in seconds instead of retyping the same content repeatedly

**Real Wedding Scenario:**
A photographer creates templates for: "Timeline confirmation request", "Engagement session details", "Gallery delivery notification", "Post-wedding follow-up". Each template includes {{couple_name}}, {{wedding_date}}, {{venue}} merge fields that auto-populate when sent.

### SPECIFICATION SOURCE
- **Feature ID:** WS-042
- **Original Spec:** /CORE-SPECIFICATIONS/02-WEDSYNC-SUPPLIER-PLATFORM/06-Communications/01-email-templates md.md
- **Current Implementation:** 0% complete

### TECHNICAL DESIGN

#### Database Schema Required
```sql
-- Email templates
CREATE TABLE IF NOT EXISTS email_templates (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  supplier_id UUID REFERENCES suppliers(id) ON DELETE CASCADE,
  name TEXT NOT NULL,
  subject TEXT NOT NULL,
  content TEXT NOT NULL,
  category TEXT DEFAULT 'general',
  merge_fields JSONB DEFAULT '[]',
  usage_count INTEGER DEFAULT 0,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);
```

#### Frontend Components Required
```typescript
// Component: EmailTemplateEditor
interface EmailTemplateEditorProps {
  template?: EmailTemplate;
  onSave: (template: EmailTemplate) => void;
  availableMergeFields: MergeField[];
}

// Key functionality:
- Rich text editor with merge field insertion
- Template preview with sample data
- Category organization
- Usage analytics
- Import/export capabilities
```

### ACCEPTANCE CRITERIA
- [x] Create and edit email templates with rich text formatting
- [x] Insert merge fields for client data (names, dates, venues)
- [x] Preview templates with sample client data
- [x] Organize templates by category (timeline, delivery, follow-up)
- [x] Performance: Template rendering in <300ms
- [x] Security: Templates isolated by supplier
- [x] Accessibility: Rich text editor keyboard accessible

### DEPENDENCIES
- Must complete after: None (standalone feature)
- Must complete before: Journey nodes that use email templates
- Shares code with: Rich text editor, email service

### ESTIMATED EFFORT
- Team A Frontend: 12 hours
- Team B Backend: 6 hours
- Team C Integration: 8 hours
- Team E AI: 4 hours
- Total: 30 hours