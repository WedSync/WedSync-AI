# TECHNICAL SPECIFICATION: WS-154 - Seating Arrangements
## Generated by Feature Development Session - August 23, 2025

### USER STORY & BUSINESS CONTEXT (THINK HARD - BE FACTUAL)
**As a:** Wedding couple planning reception seating
**I want to:** Assign guests to tables with conflict avoidance and relationship optimization
**So that:** Everyone sits with compatible people and table dynamics are harmonious

**Real Wedding Scenario:**
A couple currently draws table assignments on paper, forgetting that "Uncle Bob doesn't get along with Cousin Jim." With this feature, they set relationship rules and get warnings like "Table 5 conflict: Bob Smith marked as 'incompatible' with Jim Johnson" before finalizing arrangements.

### SPECIFICATION SOURCE
- **Feature ID:** WS-154
- **Original Spec:** /CORE-SPECIFICATIONS/03-WEDME-COUPLE-PLATFORM/04-Guest-Management/05-seating-arrangements md.md

### TECHNICAL DESIGN

#### Database Schema Required
```sql
CREATE TABLE IF NOT EXISTS reception_tables (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  couple_id UUID REFERENCES couples(id),
  table_number INTEGER NOT NULL,
  capacity INTEGER DEFAULT 8,
  table_shape VARCHAR(20) CHECK (table_shape IN ('round', 'rectangular', 'square')),
  location_notes TEXT,
  special_requirements TEXT
);

CREATE TABLE IF NOT EXISTS guest_relationships (
  guest1_id UUID REFERENCES guests(id),
  guest2_id UUID REFERENCES guests(id),
  relationship_type VARCHAR(50) CHECK (relationship_type IN ('prefer_together', 'avoid', 'incompatible', 'family', 'couple')),
  notes TEXT,
  PRIMARY KEY (guest1_id, guest2_id)
);
```

#### API Endpoints Required
```typescript
// POST /api/seating/optimize
interface OptimizeSeatingRequest {
  table_count: number;
  table_capacity: number;
  preferences: Array<{
    guest_id: string;
    preferences: string[];
  }>;
}

// PUT /api/guests/:id/table
interface AssignTableRequest {
  table_number: number;
}
```

### CODE EXAMPLES

```typescript
export function SeatingChart({ coupleId, guests }: { coupleId: string; guests: Guest[] }) {
  const [tables, setTables] = useState<Table[]>([]);
  const [conflicts, setConflicts] = useState<SeatingConflict[]>([]);

  const assignGuestToTable = async (guestId: string, tableNumber: number) => {
    const { error } = await supabase
      .from('guests')
      .update({ table_number: tableNumber })
      .eq('id', guestId);

    if (!error) {
      await checkSeatingConflicts();
    }
  };

  return (
    <div className="seating-chart">
      <h2>Reception Seating Chart</h2>
      {/* Interactive table layout */}
    </div>
  );
}
```

### ACCEPTANCE CRITERIA
- [x] Visual drag-and-drop seating chart interface
- [x] Relationship-based conflict detection
- [x] Auto-optimization suggestions for table assignments
- [x] Table capacity and shape customization
- [x] Export seating chart for venue coordination

### DEPENDENCIES
- Must complete after: WS-151 (Guest List Builder)
- Estimated Effort: 42 hours total