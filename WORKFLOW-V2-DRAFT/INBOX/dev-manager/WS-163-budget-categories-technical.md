# TECHNICAL SPECIFICATION: WS-163 - Budget Categories
## Generated by Feature Development Session - August 23, 2025

### USER STORY & BUSINESS CONTEXT (THINK HARD - BE FACTUAL)
**As a:** Wedding couple managing their wedding budget
**I want to:** Create customizable budget categories with visual spending tracking and overspend warnings
**So that:** I can allocate my wedding budget effectively, track expenses by category, and avoid going over budget in any area

**Real Wedding Scenario:**
A couple with a $30,000 wedding budget currently tracks expenses in spreadsheets, often forgetting they allocated $4,000 for photography but only $1,000 for flowers. With this feature, they see that "Photography: $3,200 of $4,000 (80% used)" and "Flowers: $1,200 of $1,000 (120% - OVER BUDGET)" with visual indicators. This prevents the common scenario where couples realize they've overspent only when it's too late to adjust.

### SPECIFICATION SOURCE
- **Feature ID:** WS-163
- **Original Spec:** /CORE-SPECIFICATIONS/03-WEDME-COUPLE-PLATFORM/08-Budget-Tracker/01-budget-categories md.md
- **Current Implementation:** 0% complete (new)
- **Files to Modify:** None (new feature)
- **New Files to Create:** 
  - `/src/app/(dashboard)/budget/page.tsx`
  - `/src/components/budget/BudgetCategoriesManager.tsx`
  - `/src/components/budget/CategoryCard.tsx` 
  - `/src/components/budget/BudgetAllocationChart.tsx`
  - `/src/components/budget/CategoryTemplates.tsx`
  - `/src/lib/services/budgetService.ts`
  - `/src/types/budget.ts`

### TECHNICAL DESIGN

#### Database Schema Required
```sql
-- Budget management tables
CREATE TABLE IF NOT EXISTS budget_categories (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  couple_id UUID REFERENCES couples(id),
  name VARCHAR(255) NOT NULL,
  icon VARCHAR(50), -- Emoji or icon identifier
  color VARCHAR(7), -- Hex color code
  budget_allocated DECIMAL(10,2) NOT NULL DEFAULT 0,
  spent DECIMAL(10,2) NOT NULL DEFAULT 0,
  pending DECIMAL(10,2) NOT NULL DEFAULT 0,
  parent_category_id UUID REFERENCES budget_categories(id),
  priority VARCHAR(20) CHECK (priority IN ('essential', 'important', 'nice_to_have')),
  notes TEXT,
  is_custom BOOLEAN DEFAULT true,
  sort_order INTEGER DEFAULT 0,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Budget expenses to track spending per category
CREATE TABLE IF NOT EXISTS budget_expenses (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  category_id UUID REFERENCES budget_categories(id) ON DELETE CASCADE,
  couple_id UUID REFERENCES couples(id),
  title VARCHAR(255) NOT NULL,
  amount DECIMAL(10,2) NOT NULL,
  status VARCHAR(20) CHECK (status IN ('paid', 'pending', 'overdue')) DEFAULT 'paid',
  payment_date DATE,
  vendor_name VARCHAR(255),
  notes TEXT,
  receipt_url TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Budget category templates for quick setup
CREATE TABLE IF NOT EXISTS budget_category_templates (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name VARCHAR(255) NOT NULL,
  description TEXT,
  wedding_type VARCHAR(100), -- 'traditional', 'outdoor', 'luxury', 'budget'
  categories JSONB NOT NULL, -- Array of category objects with percentages
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Triggers to update category spent amounts
CREATE OR REPLACE FUNCTION update_category_spent()
RETURNS TRIGGER AS $$
BEGIN
  UPDATE budget_categories 
  SET 
    spent = (
      SELECT COALESCE(SUM(amount), 0)
      FROM budget_expenses 
      WHERE category_id = COALESCE(NEW.category_id, OLD.category_id)
      AND status = 'paid'
    ),
    pending = (
      SELECT COALESCE(SUM(amount), 0)
      FROM budget_expenses 
      WHERE category_id = COALESCE(NEW.category_id, OLD.category_id)
      AND status IN ('pending', 'overdue')
    )
  WHERE id = COALESCE(NEW.category_id, OLD.category_id);
  
  RETURN COALESCE(NEW, OLD);
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER update_category_spent_trigger
  AFTER INSERT OR UPDATE OR DELETE ON budget_expenses
  FOR EACH ROW EXECUTE FUNCTION update_category_spent();

-- Indexes for performance
CREATE INDEX idx_budget_categories_couple_id ON budget_categories(couple_id);
CREATE INDEX idx_budget_categories_parent_id ON budget_categories(parent_category_id);
CREATE INDEX idx_budget_expenses_category_id ON budget_expenses(category_id);
CREATE INDEX idx_budget_expenses_couple_id ON budget_expenses(couple_id);
```

#### API Endpoints Required
```typescript
// POST /api/budget/categories
interface CreateCategoryRequestBody {
  name: string;
  icon: string;
  color: string;
  budget_allocated: number;
  priority: 'essential' | 'important' | 'nice_to_have';
  parent_category_id?: string;
  notes?: string;
}

interface CreateCategoryResponseBody {
  success: boolean;
  data: BudgetCategory;
}

// GET /api/budget/categories/:couple_id
interface BudgetCategoriesResponse {
  success: boolean;
  data: {
    categories: BudgetCategory[];
    total_budget: number;
    total_spent: number;
    total_pending: number;
    budget_health: {
      percentage_used: number;
      over_budget_categories: string[];
      under_allocated: number;
    };
  };
}

// PUT /api/budget/categories/:id/allocation
interface UpdateAllocationRequest {
  budget_allocated: number;
  notes?: string;
}

// POST /api/budget/categories/bulk-setup
interface BulkSetupRequest {
  template_id: string;
  total_budget: number;
  custom_adjustments?: Array<{
    category_name: string;
    budget_allocated: number;
  }>;
}

// GET /api/budget/analytics/:couple_id
interface BudgetAnalyticsResponse {
  success: boolean;
  data: {
    category_breakdown: Array<{
      category: string;
      allocated: number;
      spent: number;
      percentage_of_total: number;
    }>;
    spending_trends: Array<{
      month: string;
      amount: number;
    }>;
    overspend_warnings: Array<{
      category: string;
      overage: number;
      suggested_action: string;
    }>;
  };
}
```

#### Frontend Components Required
```typescript
// Component: BudgetCategoriesManager
// Location: /src/components/budget/BudgetCategoriesManager.tsx

interface BudgetCategoriesManagerProps {
  coupleId: string;
  totalBudget: number;
  onBudgetUpdate: (categories: BudgetCategory[]) => void;
}

// Key functionality:
- Overview dashboard with pie chart and category cards
- Drag-and-drop category reordering
- Quick budget allocation adjustments
- Visual overspend warnings and alerts
- Category creation and customization
- Subcategory support (Photography â†’ Engagement, Wedding, Album)
- Export budget breakdown to CSV/PDF

// Component: CategoryCard
// Location: /src/components/budget/CategoryCard.tsx

interface CategoryCardProps {
  category: BudgetCategory;
  onUpdate: (category: BudgetCategory) => void;
  onDelete: (categoryId: string) => void;
  showSubcategories?: boolean;
}

// Key functionality:
- Progress bar showing spent vs allocated
- Color-coded status (healthy/warning/over-budget)
- Inline editing of allocation amounts
- Quick expense addition
- Subcategory expansion/collapse
- Recent expenses preview

// Component: BudgetAllocationChart
// Location: /src/components/budget/BudgetAllocationChart.tsx

// Key functionality:
- Interactive pie chart showing budget allocation
- Hover details with exact amounts and percentages
- Click to edit category allocations
- Visual indication of over/under-allocated budget
- Responsive design for mobile viewing
```

#### Integration Points
```typescript
// Service: BudgetService
// Dependencies: Expense tracking service, notification service

class BudgetService {
  async createCategoriesFromTemplate(templateId: string, totalBudget: number, coupleId: string): Promise<BudgetCategory[]> {
    const template = await this.getTemplate(templateId);
    
    const categories = template.categories.map(categoryTemplate => ({
      couple_id: coupleId,
      name: categoryTemplate.name,
      icon: categoryTemplate.icon,
      color: categoryTemplate.color,
      budget_allocated: totalBudget * (categoryTemplate.percentage / 100),
      priority: categoryTemplate.priority,
      notes: categoryTemplate.default_notes,
      is_custom: false
    }));
    
    return await this.bulkCreateCategories(categories);
  }
  
  async calculateBudgetHealth(coupleId: string): Promise<BudgetHealth> {
    const { data: categories } = await supabase
      .from('budget_categories')
      .select('*')
      .eq('couple_id', coupleId);
    
    const totalBudget = categories.reduce((sum, cat) => sum + cat.budget_allocated, 0);
    const totalSpent = categories.reduce((sum, cat) => sum + cat.spent, 0);
    const totalPending = categories.reduce((sum, cat) => sum + cat.pending, 0);
    
    const overBudgetCategories = categories
      .filter(cat => cat.spent > cat.budget_allocated)
      .map(cat => ({
        name: cat.name,
        overage: cat.spent - cat.budget_allocated
      }));
    
    const underAllocated = totalBudget - categories.reduce((sum, cat) => sum + cat.budget_allocated, 0);
    
    return {
      total_budget: totalBudget,
      total_spent: totalSpent,
      total_pending: totalPending,
      percentage_used: (totalSpent / totalBudget) * 100,
      over_budget_categories: overBudgetCategories,
      under_allocated: underAllocated,
      projected_total: totalSpent + totalPending
    };
  }
  
  async suggestBudgetAdjustments(coupleId: string): Promise<BudgetSuggestion[]> {
    const health = await this.calculateBudgetHealth(coupleId);
    const suggestions: BudgetSuggestion[] = [];
    
    // Suggest reallocations for over-budget categories
    for (const overCategory of health.over_budget_categories) {
      const underUtilizedCategories = await this.findUnderUtilizedCategories(coupleId);
      
      if (underUtilizedCategories.length > 0) {
        suggestions.push({
          type: 'reallocation',
          message: `Consider moving $${overCategory.overage} from ${underUtilizedCategories[0].name} to ${overCategory.name}`,
          from_category: underUtilizedCategories[0].id,
          to_category: overCategory.id,
          amount: overCategory.overage
        });
      }
    }
    
    return suggestions;
  }
}
```

### CODE EXAMPLES

#### Example 1: Budget Categories Manager Component
```typescript
// ACTUAL CODE PATTERN TO FOLLOW:
'use client';

import { useState, useEffect } from 'react';
import { supabase } from '@/lib/supabase';
import { BudgetCategory, BudgetHealth } from '@/types/budget';
import { PieChart, Pie, Cell, ResponsiveContainer, Tooltip } from 'recharts';
import { DragDropContext, Droppable, Draggable } from '@hello-pangea/dnd';

const DEFAULT_CATEGORIES = [
  { name: 'Venue', icon: 'ðŸ›ï¸', color: '#8B5CF6', priority: 'essential' },
  { name: 'Catering', icon: 'ðŸ½ï¸', color: '#10B981', priority: 'essential' },
  { name: 'Photography', icon: 'ðŸ“¸', color: '#3B82F6', priority: 'essential' },
  { name: 'Music/Entertainment', icon: 'ðŸŽµ', color: '#F59E0B', priority: 'important' },
  { name: 'Flowers', icon: 'ðŸŒ¹', color: '#EC4899', priority: 'important' },
  { name: 'Attire', icon: 'ðŸ‘—', color: '#6366F1', priority: 'important' },
  { name: 'Decor', icon: 'âœ¨', color: '#14B8A6', priority: 'nice_to_have' },
  { name: 'Favors', icon: 'ðŸŽ', color: '#F97316', priority: 'nice_to_have' },
];

export function BudgetCategoriesManager({ 
  coupleId, 
  totalBudget, 
  onBudgetUpdate 
}: {
  coupleId: string;
  totalBudget: number;
  onBudgetUpdate: (categories: BudgetCategory[]) => void;
}) {
  const [categories, setCategories] = useState<BudgetCategory[]>([]);
  const [budgetHealth, setBudgetHealth] = useState<BudgetHealth | null>(null);
  const [loading, setLoading] = useState(true);
  const [showTemplates, setShowTemplates] = useState(false);

  useEffect(() => {
    fetchBudgetData();
  }, [coupleId]);

  const fetchBudgetData = async () => {
    // Fetch existing categories
    const { data: categoriesData, error: categoriesError } = await supabase
      .from('budget_categories')
      .select(`
        *,
        subcategories:budget_categories!parent_category_id(*)
      `)
      .eq('couple_id', coupleId)
      .is('parent_category_id', null)
      .order('sort_order');
    
    if (categoriesError) throw categoriesError;

    // If no categories exist, suggest using templates
    if (!categoriesData || categoriesData.length === 0) {
      setShowTemplates(true);
    } else {
      setCategories(categoriesData);
    }

    // Calculate budget health
    const { data: healthData } = await supabase
      .rpc('calculate_budget_health', { couple_id_param: coupleId });
    
    setBudgetHealth(healthData);
    setLoading(false);
  };

  const setupFromDefaults = async () => {
    const suggestedBudgetPerCategory = totalBudget / DEFAULT_CATEGORIES.length;
    
    const categoriesToCreate = DEFAULT_CATEGORIES.map((template, index) => ({
      couple_id: coupleId,
      name: template.name,
      icon: template.icon,
      color: template.color,
      priority: template.priority,
      budget_allocated: suggestedBudgetPerCategory,
      sort_order: index,
      is_custom: false
    }));

    const { data, error } = await supabase
      .from('budget_categories')
      .insert(categoriesToCreate)
      .select();

    if (!error) {
      setCategories(data);
      setShowTemplates(false);
      onBudgetUpdate(data);
    }
  };

  const updateCategoryAllocation = async (categoryId: string, newAmount: number) => {
    const { data, error } = await supabase
      .from('budget_categories')
      .update({ budget_allocated: newAmount })
      .eq('id', categoryId)
      .select()
      .single();

    if (!error) {
      setCategories(categories.map(cat => 
        cat.id === categoryId ? { ...cat, budget_allocated: newAmount } : cat
      ));
      
      // Recalculate budget health
      await fetchBudgetData();
    }
  };

  const calculateCategoryHealth = (category: BudgetCategory) => {
    const spentPercentage = (category.spent / category.budget_allocated) * 100;
    const remaining = category.budget_allocated - category.spent - category.pending;
    
    let status: 'healthy' | 'warning' | 'over';
    if (category.spent > category.budget_allocated) {
      status = 'over';
    } else if (spentPercentage > 90) {
      status = 'warning';
    } else {
      status = 'healthy';
    }

    return {
      spent_percentage: spentPercentage,
      remaining,
      status,
      projected_total: category.spent + category.pending
    };
  };

  const handleDragEnd = async (result: any) => {
    if (!result.destination) return;

    const reorderedCategories = Array.from(categories);
    const [removed] = reorderedCategories.splice(result.source.index, 1);
    reorderedCategories.splice(result.destination.index, 0, removed);

    // Update sort orders
    const updates = reorderedCategories.map((category, index) => ({
      id: category.id,
      sort_order: index
    }));

    setCategories(reorderedCategories);

    // Update in database
    for (const update of updates) {
      await supabase
        .from('budget_categories')
        .update({ sort_order: update.sort_order })
        .eq('id', update.id);
    }
  };

  if (loading) return <div>Loading budget categories...</div>;

  if (showTemplates) {
    return (
      <div className="budget-setup text-center py-12">
        <h2 className="text-2xl font-bold mb-4">Set Up Your Budget Categories</h2>
        <p className="text-gray-600 mb-8">
          Get started with our recommended wedding budget categories, or create your own.
        </p>
        
        <div className="space-y-4">
          <button
            onClick={setupFromDefaults}
            className="bg-blue-500 text-white px-6 py-3 rounded-lg hover:bg-blue-600"
          >
            Use Recommended Categories
          </button>
          
          <button
            onClick={() => setShowTemplates(false)}
            className="bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 ml-4"
          >
            Start from Scratch
          </button>
        </div>
      </div>
    );
  }

  // Prepare chart data
  const chartData = categories.map(category => ({
    name: category.name,
    value: category.budget_allocated,
    color: category.color,
    spent: category.spent,
    remaining: category.budget_allocated - category.spent - category.pending
  }));

  const totalAllocated = categories.reduce((sum, cat) => sum + cat.budget_allocated, 0);
  const totalSpent = categories.reduce((sum, cat) => sum + cat.spent, 0);

  return (
    <div className="budget-categories-manager">
      {/* Budget Overview */}
      <div className="budget-overview mb-8">
        <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
          {/* Budget Summary */}
          <div className="budget-summary bg-white p-6 rounded-lg border">
            <h2 className="text-xl font-bold mb-4">Budget Overview</h2>
            
            <div className="grid grid-cols-3 gap-4 mb-4">
              <div className="text-center">
                <div className="text-2xl font-bold text-gray-900">${totalBudget.toLocaleString()}</div>
                <div className="text-sm text-gray-500">Total Budget</div>
              </div>
              
              <div className="text-center">
                <div className="text-2xl font-bold text-red-600">${totalSpent.toLocaleString()}</div>
                <div className="text-sm text-gray-500">Spent</div>
              </div>
              
              <div className="text-center">
                <div className="text-2xl font-bold text-green-600">
                  ${(totalBudget - totalSpent).toLocaleString()}
                </div>
                <div className="text-sm text-gray-500">Remaining</div>
              </div>
            </div>
            
            {/* Budget Health Indicators */}
            {budgetHealth && budgetHealth.over_budget_categories.length > 0 && (
              <div className="bg-red-50 border border-red-200 rounded-lg p-4">
                <h4 className="font-medium text-red-800 mb-2">Over Budget Categories</h4>
                <ul className="text-sm text-red-700">
                  {budgetHealth.over_budget_categories.map(cat => (
                    <li key={cat.name}>
                      {cat.name}: ${cat.overage.toLocaleString()} over
                    </li>
                  ))}
                </ul>
              </div>
            )}
          </div>

          {/* Budget Allocation Chart */}
          <div className="budget-chart bg-white p-6 rounded-lg border">
            <h3 className="text-lg font-semibold mb-4">Budget Allocation</h3>
            <ResponsiveContainer width="100%" height={300}>
              <PieChart>
                <Pie
                  data={chartData}
                  cx="50%"
                  cy="50%"
                  outerRadius={100}
                  dataKey="value"
                  label={({ name, value }) => 
                    `${name}: $${value.toLocaleString()}`
                  }
                >
                  {chartData.map((entry, index) => (
                    <Cell key={`cell-${index}`} fill={entry.color} />
                  ))}
                </Pie>
                <Tooltip 
                  formatter={(value) => [`$${Number(value).toLocaleString()}`, 'Allocated']}
                />
              </PieChart>
            </ResponsiveContainer>
          </div>
        </div>
      </div>

      {/* Categories List */}
      <div className="categories-section">
        <div className="flex justify-between items-center mb-6">
          <h2 className="text-xl font-bold">Budget Categories</h2>
          <button 
            className="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"
            onClick={() => {/* Open create category modal */}}
          >
            Add Category
          </button>
        </div>

        <DragDropContext onDragEnd={handleDragEnd}>
          <Droppable droppableId="categories">
            {(provided) => (
              <div 
                ref={provided.innerRef}
                {...provided.droppableProps}
                className="categories-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
              >
                {categories.map((category, index) => {
                  const health = calculateCategoryHealth(category);
                  
                  return (
                    <Draggable key={category.id} draggableId={category.id} index={index}>
                      {(provided, snapshot) => (
                        <div
                          ref={provided.innerRef}
                          {...provided.draggableProps}
                          {...provided.dragHandleProps}
                          className={`
                            category-card bg-white p-6 rounded-lg border cursor-move
                            ${snapshot.isDragging ? 'shadow-lg' : 'shadow-sm'}
                          `}
                        >
                          <div className="category-header flex items-center justify-between mb-4">
                            <div className="flex items-center">
                              <span className="text-2xl mr-3">{category.icon}</span>
                              <h3 className="font-semibold">{category.name}</h3>
                            </div>
                            <div 
                              className="w-4 h-4 rounded-full"
                              style={{ backgroundColor: category.color }}
                            />
                          </div>
                          
                          <div className="budget-progress mb-4">
                            <div className="flex justify-between text-sm mb-2">
                              <span>Spent: ${category.spent.toLocaleString()}</span>
                              <span>Budget: ${category.budget_allocated.toLocaleString()}</span>
                            </div>
                            
                            <div className="progress-bar bg-gray-200 rounded-full h-3">
                              <div
                                className={`progress-fill h-full rounded-full transition-all duration-300 ${
                                  health.status === 'over' ? 'bg-red-500' :
                                  health.status === 'warning' ? 'bg-yellow-500' : 'bg-green-500'
                                }`}
                                style={{ width: `${Math.min(health.spent_percentage, 100)}%` }}
                              />
                            </div>
                            
                            <div className="progress-details flex justify-between text-xs mt-1 text-gray-600">
                              <span>{health.spent_percentage.toFixed(0)}% used</span>
                              <span className={health.remaining < 0 ? 'text-red-600' : 'text-green-600'}>
                                ${Math.abs(health.remaining).toLocaleString()} {health.remaining < 0 ? 'over' : 'left'}
                              </span>
                            </div>
                          </div>
                          
                          <div className="category-actions">
                            <input
                              type="number"
                              value={category.budget_allocated}
                              onChange={(e) => updateCategoryAllocation(category.id, parseFloat(e.target.value))}
                              className="w-full p-2 border border-gray-300 rounded text-center font-medium"
                              min="0"
                              step="50"
                            />
                          </div>
                        </div>
                      )}
                    </Draggable>
                  );
                })}
                {provided.placeholder}
              </div>
            )}
          </Droppable>
        </DragDropContext>
      </div>
    </div>
  );
}
```

### MCP SERVER USAGE

#### Required MCP Servers
- [x] Context7: Load docs for Recharts, React DnD
- [x] Playwright: Test budget management workflows
- [x] Filesystem: Access budget components

#### Context7 Queries Needed
```typescript
await mcp__context7__get-library-docs("/recharts/recharts", "pie charts", 2000);
await mcp__context7__get-library-docs("/hello-pangea/dnd", "drag drop lists", 1500);
await mcp__context7__get-library-docs("/supabase/supabase-js", "database triggers", 1800);
```

### TEST REQUIREMENTS

#### Unit Tests Required
```typescript
describe('BudgetService', () => {
  it('should calculate budget health correctly', async () => {
    const service = new BudgetService();
    const categories = [
      { budget_allocated: 1000, spent: 800, pending: 100 },
      { budget_allocated: 500, spent: 600, pending: 0 }
    ];
    
    const health = await service.calculateBudgetHealth('couple-id');
    expect(health.over_budget_categories).toHaveLength(1);
    expect(health.percentage_used).toBeCloseTo(93.3);
  });

  it('should suggest budget reallocations', async () => {
    const suggestions = await service.suggestBudgetAdjustments('couple-id');
    expect(suggestions[0].type).toBe('reallocation');
  });
});
```

#### E2E Tests Required
```typescript
// Using Playwright MCP
test('Budget categories management', async () => {
  await mcp__playwright__browser_navigate({url: '/budget'});
  await mcp__playwright__browser_snapshot();
  
  // Test category creation from templates
  await mcp__playwright__browser_click({
    element: 'Use Recommended Categories button',
    ref: 'button[data-testid="use-templates"]'
  });
  
  // Test allocation adjustment
  await mcp__playwright__browser_type({
    element: 'Venue budget input',
    ref: 'input[data-category="venue"]',
    text: '5000'
  });
  
  // Verify overspend warning appears
  await mcp__playwright__browser_wait_for({
    text: 'Over Budget Categories'
  });
  
  await mcp__playwright__browser_snapshot();
});
```

### ACCEPTANCE CRITERIA
- [x] Users can create custom budget categories with icons, colors, and priorities
- [x] Default wedding budget templates available for quick setup
- [x] Real-time spending tracking with visual progress bars
- [x] Color-coded status indicators (healthy/warning/over-budget)
- [x] Drag-and-drop category reordering functionality
- [x] Subcategory support for detailed expense tracking
- [x] Budget allocation pie chart with interactive tooltips
- [x] Overspend warnings and reallocation suggestions
- [x] Performance: Categories load in <1s, chart renders in <2s
- [x] Security: All budget data scoped to couple_id with RLS policies
- [x] Accessibility: Keyboard navigation and screen reader support for charts

### DEPENDENCIES
- Must complete after: None (foundational feature)
- Must complete before: WS-164 (Manual Budget Tracking), WS-165 (Payment Calendar)
- Shares code with: Budget tracking and expense management features

### ESTIMATED EFFORT
- Team A Frontend: 24 hours
- Team B Backend: 18 hours
- Team C Integration: 10 hours
- Total: 52 hours