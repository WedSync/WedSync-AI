'use client';

import React from 'react';
import Link from 'next/link';
import { AppleCalendarSync } from '@/components/calendar/AppleCalendarSync';
import { 
  ArrowLeftIcon,
  InformationCircleIcon,
  ShieldCheckIcon,
  DevicePhoneMobileIcon,
  ComputerDesktopIcon,
  WatchIcon
} from '@heroicons/react/20/solid';

export default function AppleCalendarSettingsPage() {
  const handleSyncStatusChange = (status: any) => {
    console.log('Apple Calendar sync status changed:', status);
    // Handle sync status updates - could update UI state, show notifications, etc.
  };

  const handleConflictResolved = (conflictId: string, resolution: string) => {
    console.log('Conflict resolved:', conflictId, resolution);
    // Handle conflict resolution - could update analytics, show success message, etc.
  };

  return (
    <div className="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      {/* Breadcrumb Navigation */}
      <nav className="flex mb-6" aria-label="Breadcrumb">
        <ol className="inline-flex items-center space-x-1 md:space-x-3">
          <li className="inline-flex items-center">
            <Link
              href="/settings"
              className="inline-flex items-center text-sm font-medium text-gray-700 hover:text-indigo-600"
            >
              Settings
            </Link>
          </li>
          <li>
            <div className="flex items-center">
              <svg className="w-6 h-6 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                <path fillRule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clipRule="evenodd" />
              </svg>
              <Link
                href="/settings/calendar-integration"
                className="ml-1 text-sm font-medium text-gray-700 hover:text-indigo-600 md:ml-2"
              >
                Calendar Integration
              </Link>
            </div>
          </li>
          <li>
            <div className="flex items-center">
              <svg className="w-6 h-6 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                <path fillRule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clipRule="evenodd" />
              </svg>
              <span className="ml-1 text-sm font-medium text-gray-500 md:ml-2">Apple Calendar</span>
            </div>
          </li>
        </ol>
      </nav>

      {/* Back Button */}
      <div className="mb-4">
        <Link
          href="/settings/calendar-integration"
          className="inline-flex items-center text-sm font-medium text-indigo-600 hover:text-indigo-500"
        >
          <ArrowLeftIcon className="h-4 w-4 mr-1" />
          Back to Calendar Integration
        </Link>
      </div>

      {/* Header */}
      <div className="pb-5 border-b border-gray-200">
        <div className="flex items-center">
          <div className="text-4xl mr-3">üçé</div>
          <div>
            <h1 className="text-2xl font-bold leading-7 text-gray-900 sm:truncate">
              Apple Calendar Integration
            </h1>
            <p className="mt-1 text-sm text-gray-500">
              Connect with Apple Calendar using CalDAV protocol for seamless sync across all your Apple devices
            </p>
          </div>
        </div>
      </div>

      {/* Benefits Section */}
      <div className="mt-6 grid grid-cols-1 gap-4 sm:grid-cols-3">
        <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
          <div className="flex items-center">
            <DevicePhoneMobileIcon className="h-8 w-8 text-blue-600" />
            <div className="ml-3">
              <h3 className="text-sm font-medium text-blue-800">iPhone Integration</h3>
              <p className="text-sm text-blue-600">Sync with your iPhone calendar app and get Siri notifications</p>
            </div>
          </div>
        </div>

        <div className="bg-purple-50 border border-purple-200 rounded-lg p-4">
          <div className="flex items-center">
            <ComputerDesktopIcon className="h-8 w-8 text-purple-600" />
            <div className="ml-3">
              <h3 className="text-sm font-medium text-purple-800">Mac & iPad Sync</h3>
              <p className="text-sm text-purple-600">Access wedding schedules on your Mac and iPad Calendar apps</p>
            </div>
          </div>
        </div>

        <div className="bg-green-50 border border-green-200 rounded-lg p-4">
          <div className="flex items-center">
            <WatchIcon className="h-8 w-8 text-green-600" />
            <div className="ml-3">
              <h3 className="text-sm font-medium text-green-800">Apple Watch</h3>
              <p className="text-sm text-green-600">Get wedding appointment reminders on your Apple Watch</p>
            </div>
          </div>
        </div>
      </div>

      {/* Security Notice */}
      <div className="mt-6 bg-amber-50 border border-amber-200 rounded-lg p-4">
        <div className="flex">
          <div className="flex-shrink-0">
            <ShieldCheckIcon className="h-5 w-5 text-amber-400" />
          </div>
          <div className="ml-3">
            <h3 className="text-sm font-medium text-amber-800">
              Secure CalDAV Connection
            </h3>
            <div className="mt-2 text-sm text-amber-700">
              <p>
                This integration uses Apple's secure CalDAV protocol with app-specific passwords. 
                Your main Apple ID password is never stored or transmitted. All calendar data is 
                encrypted in transit using HTTPS/TLS.
              </p>
            </div>
          </div>
        </div>
      </div>

      {/* Setup Instructions */}
      <div className="mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4">
        <div className="flex">
          <div className="flex-shrink-0">
            <InformationCircleIcon className="h-5 w-5 text-blue-400" />
          </div>
          <div className="ml-3">
            <h3 className="text-sm font-medium text-blue-800">
              Before You Start
            </h3>
            <div className="mt-2 text-sm text-blue-700">
              <p className="mb-2">To connect your Apple Calendar, you'll need:</p>
              <ol className="list-decimal list-inside space-y-1">
                <li>Your Apple ID email address</li>
                <li>An app-specific password (generated from appleid.apple.com)</li>
                <li>Two-factor authentication enabled on your Apple ID</li>
              </ol>
              <p className="mt-2">
                <a 
                  href="https://support.apple.com/en-us/102654" 
                  target="_blank" 
                  rel="noopener noreferrer"
                  className="text-blue-600 hover:text-blue-500 font-medium underline"
                >
                  Learn how to create an app-specific password ‚Üí
                </a>
              </p>
            </div>
          </div>
        </div>
      </div>

      {/* Main Apple Calendar Integration Component */}
      <div className="mt-8">
        <AppleCalendarSync
          className="max-w-none"
          onSyncStatusChange={handleSyncStatusChange}
          onConflictResolved={handleConflictResolved}
          initialView="setup"
        />
      </div>

      {/* Wedding Professional Tips */}
      <div className="mt-8 bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200 rounded-lg p-6">
        <h3 className="text-lg font-medium text-purple-900 mb-4">
          Tips for Wedding Professionals
        </h3>
        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <h4 className="text-sm font-medium text-purple-800 mb-2">Event Categories</h4>
            <ul className="text-sm text-purple-700 space-y-1">
              <li>‚Ä¢ Client consultations will sync as "Client Meeting"</li>
              <li>‚Ä¢ Venue visits appear as "Venue Visit"</li>
              <li>‚Ä¢ Wedding ceremonies are marked "Wedding Ceremony"</li>
              <li>‚Ä¢ Reception events show as "Wedding Reception"</li>
            </ul>
          </div>
          <div>
            <h4 className="text-sm font-medium text-purple-800 mb-2">Mobile Workflow</h4>
            <ul className="text-sm text-purple-700 space-y-1">
              <li>‚Ä¢ Book appointments on your iPhone on-the-go</li>
              <li>‚Ä¢ Get Apple Watch notifications for wedding day timeline</li>
              <li>‚Ä¢ Use Siri to check your wedding schedule</li>
              <li>‚Ä¢ Access maps and driving directions from Calendar app</li>
            </ul>
          </div>
        </div>
      </div>

      {/* Troubleshooting Section */}
      <div className="mt-8 bg-gray-50 rounded-lg p-6">
        <h3 className="text-lg font-medium text-gray-900">Troubleshooting</h3>
        <div className="mt-4 space-y-4">
          <div>
            <h4 className="text-sm font-medium text-gray-800">Connection Issues</h4>
            <ul className="mt-1 text-sm text-gray-600 space-y-1">
              <li>‚Ä¢ Ensure two-factor authentication is enabled on your Apple ID</li>
              <li>‚Ä¢ Generate a fresh app-specific password if authentication fails</li>
              <li>‚Ä¢ Check that your Apple ID hasn't been locked or suspended</li>
            </ul>
          </div>
          <div>
            <h4 className="text-sm font-medium text-gray-800">Sync Problems</h4>
            <ul className="mt-1 text-sm text-gray-600 space-y-1">
              <li>‚Ä¢ Events may take up to 15 minutes to appear across devices</li>
              <li>‚Ä¢ Check your internet connection and iCloud status</li>
              <li>‚Ä¢ Restart the Calendar app on your devices after setup</li>
            </ul>
          </div>
        </div>
        <div className="mt-6 flex space-x-4">
          <Link
            href="/help/apple-calendar"
            className="text-sm font-medium text-indigo-600 hover:text-indigo-500"
          >
            Detailed Setup Guide
          </Link>
          <Link
            href="/support/calendar/apple"
            className="text-sm font-medium text-indigo-600 hover:text-indigo-500"
          >
            Contact Support
          </Link>
        </div>
      </div>
    </div>
  );
}